

CREATE TABLE `prod_ccall.prod_to_call`(
	  `phone_num` string, 
	  `rnk` int, 
      `segment_nm` string,
      `seg_score` float,
	  `load_dttm` timestamp)
	PARTITIONED BY ( 
	  `ymd` string)
;

CREATE TABLE `prod_ccall.test_to_call`(
	  `phone_num` string, 
	  `rnk` int, 
      `segment_nm` string,
      `seg_score` float,
	  `load_dttm` timestamp)
	PARTITIONED BY ( 
	  `ymd` string)
;


CREATE TABLE `prod_lookalike.la_apppr_ccall_2_raw`(
	  `phone_num` string, 	  
	  `score` double, 
	  `segment_nm` string,
           load_dttm timestamp)
comment 'Raw data for segments. Data stored for a several last days.'
partitioned by ( `ymd` string)
stored as RCfile;




-- testing script 1
select * from (select 'prod' as name, ymd,count(*) from prod_ccall.prod_segments group by ymd) a union all
select * from (select 'test' as name, ymd,count(*) from prod_ccall.test_segments group by ymd) a;

-- testing script 2
select ymd,segment_nm,count(*) 
from phone_x_segment
where ymd > '2017-02-20'
group by ymd,segment_nm
;
