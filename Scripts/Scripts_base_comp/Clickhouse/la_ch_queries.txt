DROP TABLE IF EXISTS kosm.id_up_20160817;
CREATE TABLE kosm.id_up_20160817 (ymd Date, uid String, up String, cnt UInt32, duration UInt32) ENGINE = MergeTree(ymd, (uid, up, ymd), 8192);

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '' and uid <= '00'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '' and uid <= '00'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '' and uid <= '00'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '' and uid <= '00'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '00' and uid <= '02'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '00' and uid <= '02'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '00' and uid <= '02'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '00' and uid <= '02'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '02' and uid <= '04'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '02' and uid <= '04'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '02' and uid <= '04'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '02' and uid <= '04'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '04' and uid <= '06'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '04' and uid <= '06'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '04' and uid <= '06'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '04' and uid <= '06'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '06' and uid <= '08'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '06' and uid <= '08'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '06' and uid <= '08'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '06' and uid <= '08'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '08' and uid <= '0A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '08' and uid <= '0A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '08' and uid <= '0A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '08' and uid <= '0A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '0A' and uid <= '0C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '0A' and uid <= '0C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '0A' and uid <= '0C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '0A' and uid <= '0C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '0C' and uid <= '0E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '0C' and uid <= '0E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '0C' and uid <= '0E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '0C' and uid <= '0E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '0E' and uid <= '10'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '0E' and uid <= '10'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '0E' and uid <= '10'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '0E' and uid <= '10'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '10' and uid <= '12'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '10' and uid <= '12'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '10' and uid <= '12'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '10' and uid <= '12'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '12' and uid <= '14'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '12' and uid <= '14'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '12' and uid <= '14'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '12' and uid <= '14'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '14' and uid <= '16'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '14' and uid <= '16'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '14' and uid <= '16'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '14' and uid <= '16'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '16' and uid <= '18'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '16' and uid <= '18'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '16' and uid <= '18'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '16' and uid <= '18'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '18' and uid <= '1A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '18' and uid <= '1A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '18' and uid <= '1A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '18' and uid <= '1A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '1A' and uid <= '1C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '1A' and uid <= '1C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '1A' and uid <= '1C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '1A' and uid <= '1C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '1C' and uid <= '1E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '1C' and uid <= '1E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '1C' and uid <= '1E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '1C' and uid <= '1E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '1E' and uid <= '20'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '1E' and uid <= '20'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '1E' and uid <= '20'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '1E' and uid <= '20'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '20' and uid <= '22'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '20' and uid <= '22'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '20' and uid <= '22'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '20' and uid <= '22'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '22' and uid <= '24'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '22' and uid <= '24'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '22' and uid <= '24'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '22' and uid <= '24'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '24' and uid <= '26'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '24' and uid <= '26'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '24' and uid <= '26'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '24' and uid <= '26'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '26' and uid <= '28'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '26' and uid <= '28'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '26' and uid <= '28'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '26' and uid <= '28'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '28' and uid <= '2A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '28' and uid <= '2A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '28' and uid <= '2A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '28' and uid <= '2A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '2A' and uid <= '2C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '2A' and uid <= '2C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '2A' and uid <= '2C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '2A' and uid <= '2C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '2C' and uid <= '2E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '2C' and uid <= '2E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '2C' and uid <= '2E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '2C' and uid <= '2E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '2E' and uid <= '30'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '2E' and uid <= '30'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '2E' and uid <= '30'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '2E' and uid <= '30'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '30' and uid <= '32'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '30' and uid <= '32'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '30' and uid <= '32'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '30' and uid <= '32'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '32' and uid <= '34'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '32' and uid <= '34'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '32' and uid <= '34'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '32' and uid <= '34'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '34' and uid <= '36'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '34' and uid <= '36'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '34' and uid <= '36'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '34' and uid <= '36'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '36' and uid <= '38'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '36' and uid <= '38'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '36' and uid <= '38'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '36' and uid <= '38'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '38' and uid <= '3A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '38' and uid <= '3A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '38' and uid <= '3A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '38' and uid <= '3A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '3A' and uid <= '3C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '3A' and uid <= '3C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '3A' and uid <= '3C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '3A' and uid <= '3C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '3C' and uid <= '3E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '3C' and uid <= '3E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '3C' and uid <= '3E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '3C' and uid <= '3E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '3E' and uid <= '40'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '3E' and uid <= '40'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '3E' and uid <= '40'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '3E' and uid <= '40'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '40' and uid <= '42'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '40' and uid <= '42'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '40' and uid <= '42'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '40' and uid <= '42'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '42' and uid <= '44'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '42' and uid <= '44'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '42' and uid <= '44'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '42' and uid <= '44'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '44' and uid <= '46'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '44' and uid <= '46'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '44' and uid <= '46'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '44' and uid <= '46'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '46' and uid <= '48'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '46' and uid <= '48'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '46' and uid <= '48'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '46' and uid <= '48'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '48' and uid <= '4A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '48' and uid <= '4A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '48' and uid <= '4A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '48' and uid <= '4A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '4A' and uid <= '4C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '4A' and uid <= '4C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '4A' and uid <= '4C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '4A' and uid <= '4C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '4C' and uid <= '4E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '4C' and uid <= '4E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '4C' and uid <= '4E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '4C' and uid <= '4E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '4E' and uid <= '50'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '4E' and uid <= '50'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '4E' and uid <= '50'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '4E' and uid <= '50'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '50' and uid <= '52'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '50' and uid <= '52'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '50' and uid <= '52'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '50' and uid <= '52'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '52' and uid <= '54'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '52' and uid <= '54'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '52' and uid <= '54'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '52' and uid <= '54'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '54' and uid <= '56'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '54' and uid <= '56'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '54' and uid <= '56'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '54' and uid <= '56'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '56' and uid <= '58'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '56' and uid <= '58'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '56' and uid <= '58'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '56' and uid <= '58'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '58' and uid <= '5A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '58' and uid <= '5A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '58' and uid <= '5A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '58' and uid <= '5A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '5A' and uid <= '5C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '5A' and uid <= '5C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '5A' and uid <= '5C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '5A' and uid <= '5C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '5C' and uid <= '5E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '5C' and uid <= '5E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '5C' and uid <= '5E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '5C' and uid <= '5E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '5E' and uid <= '60'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '5E' and uid <= '60'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '5E' and uid <= '60'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '5E' and uid <= '60'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '60' and uid <= '62'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '60' and uid <= '62'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '60' and uid <= '62'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '60' and uid <= '62'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '62' and uid <= '64'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '62' and uid <= '64'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '62' and uid <= '64'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '62' and uid <= '64'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '64' and uid <= '66'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '64' and uid <= '66'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '64' and uid <= '66'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '64' and uid <= '66'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '66' and uid <= '68'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '66' and uid <= '68'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '66' and uid <= '68'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '66' and uid <= '68'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '68' and uid <= '6A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '68' and uid <= '6A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '68' and uid <= '6A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '68' and uid <= '6A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '6A' and uid <= '6C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '6A' and uid <= '6C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '6A' and uid <= '6C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '6A' and uid <= '6C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '6C' and uid <= '6E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '6C' and uid <= '6E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '6C' and uid <= '6E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '6C' and uid <= '6E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '6E' and uid <= '70'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '6E' and uid <= '70'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '6E' and uid <= '70'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '6E' and uid <= '70'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '70' and uid <= '72'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '70' and uid <= '72'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '70' and uid <= '72'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '70' and uid <= '72'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '72' and uid <= '74'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '72' and uid <= '74'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '72' and uid <= '74'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '72' and uid <= '74'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '74' and uid <= '76'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '74' and uid <= '76'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '74' and uid <= '76'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '74' and uid <= '76'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '76' and uid <= '78'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '76' and uid <= '78'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '76' and uid <= '78'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '76' and uid <= '78'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '78' and uid <= '7A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '78' and uid <= '7A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '78' and uid <= '7A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '78' and uid <= '7A'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '7A' and uid <= '7C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '7A' and uid <= '7C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '7A' and uid <= '7C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '7A' and uid <= '7C'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '7C' and uid <= '7E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '7C' and uid <= '7E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '7C' and uid <= '7E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '7C' and uid <= '7E'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '7E' and uid <= '81'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '7E' and uid <= '81'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '7E' and uid <= '81'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '7E' and uid <= '81'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '81' and uid <= '83'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '81' and uid <= '83'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '81' and uid <= '83'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '81' and uid <= '83'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '83' and uid <= '85'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '83' and uid <= '85'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '83' and uid <= '85'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '83' and uid <= '85'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '85' and uid <= '87'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '85' and uid <= '87'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '85' and uid <= '87'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '85' and uid <= '87'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '87' and uid <= '89'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '87' and uid <= '89'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '87' and uid <= '89'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '87' and uid <= '89'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '89' and uid <= '8B'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '89' and uid <= '8B'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '89' and uid <= '8B'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '89' and uid <= '8B'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '8B' and uid <= '8D'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '8B' and uid <= '8D'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '8B' and uid <= '8D'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '8B' and uid <= '8D'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '8D' and uid <= '8F'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '8D' and uid <= '8F'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '8D' and uid <= '8F'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '8D' and uid <= '8F'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '8F' and uid <= '91'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '8F' and uid <= '91'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '8F' and uid <= '91'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '8F' and uid <= '91'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '91' and uid <= '93'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '91' and uid <= '93'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '91' and uid <= '93'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '91' and uid <= '93'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '93' and uid <= '95'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '93' and uid <= '95'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '93' and uid <= '95'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '93' and uid <= '95'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '95' and uid <= '97'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '95' and uid <= '97'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '95' and uid <= '97'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '95' and uid <= '97'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '97' and uid <= '99'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '97' and uid <= '99'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '97' and uid <= '99'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '97' and uid <= '99'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '99' and uid <= '9B'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '99' and uid <= '9B'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '99' and uid <= '9B'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '99' and uid <= '9B'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '9B' and uid <= '9D'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '9B' and uid <= '9D'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '9B' and uid <= '9D'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '9B' and uid <= '9D'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '9D' and uid <= '9F'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '9D' and uid <= '9F'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '9D' and uid <= '9F'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '9D' and uid <= '9F'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > '9F' and uid <= 'A1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > '9F' and uid <= 'A1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '9F' and uid <= 'A1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > '9F' and uid <= 'A1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'A1' and uid <= 'A3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'A1' and uid <= 'A3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'A1' and uid <= 'A3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'A1' and uid <= 'A3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'A3' and uid <= 'A5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'A3' and uid <= 'A5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'A3' and uid <= 'A5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'A3' and uid <= 'A5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'A5' and uid <= 'A7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'A5' and uid <= 'A7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'A5' and uid <= 'A7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'A5' and uid <= 'A7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'A7' and uid <= 'A9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'A7' and uid <= 'A9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'A7' and uid <= 'A9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'A7' and uid <= 'A9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'A9' and uid <= 'AB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'A9' and uid <= 'AB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'A9' and uid <= 'AB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'A9' and uid <= 'AB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'AB' and uid <= 'AD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'AB' and uid <= 'AD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'AB' and uid <= 'AD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'AB' and uid <= 'AD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'AD' and uid <= 'AF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'AD' and uid <= 'AF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'AD' and uid <= 'AF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'AD' and uid <= 'AF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'AF' and uid <= 'B1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'AF' and uid <= 'B1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'AF' and uid <= 'B1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'AF' and uid <= 'B1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'B1' and uid <= 'B3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'B1' and uid <= 'B3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'B1' and uid <= 'B3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'B1' and uid <= 'B3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'B3' and uid <= 'B5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'B3' and uid <= 'B5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'B3' and uid <= 'B5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'B3' and uid <= 'B5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'B5' and uid <= 'B7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'B5' and uid <= 'B7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'B5' and uid <= 'B7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'B5' and uid <= 'B7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'B7' and uid <= 'B9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'B7' and uid <= 'B9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'B7' and uid <= 'B9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'B7' and uid <= 'B9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'B9' and uid <= 'BB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'B9' and uid <= 'BB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'B9' and uid <= 'BB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'B9' and uid <= 'BB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'BB' and uid <= 'BD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'BB' and uid <= 'BD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'BB' and uid <= 'BD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'BB' and uid <= 'BD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'BD' and uid <= 'BF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'BD' and uid <= 'BF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'BD' and uid <= 'BF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'BD' and uid <= 'BF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'BF' and uid <= 'C1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'BF' and uid <= 'C1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'BF' and uid <= 'C1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'BF' and uid <= 'C1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'C1' and uid <= 'C3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'C1' and uid <= 'C3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'C1' and uid <= 'C3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'C1' and uid <= 'C3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'C3' and uid <= 'C5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'C3' and uid <= 'C5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'C3' and uid <= 'C5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'C3' and uid <= 'C5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'C5' and uid <= 'C7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'C5' and uid <= 'C7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'C5' and uid <= 'C7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'C5' and uid <= 'C7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'C7' and uid <= 'C9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'C7' and uid <= 'C9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'C7' and uid <= 'C9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'C7' and uid <= 'C9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'C9' and uid <= 'CB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'C9' and uid <= 'CB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'C9' and uid <= 'CB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'C9' and uid <= 'CB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'CB' and uid <= 'CD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'CB' and uid <= 'CD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'CB' and uid <= 'CD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'CB' and uid <= 'CD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'CD' and uid <= 'CF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'CD' and uid <= 'CF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'CD' and uid <= 'CF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'CD' and uid <= 'CF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'CF' and uid <= 'D1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'CF' and uid <= 'D1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'CF' and uid <= 'D1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'CF' and uid <= 'D1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'D1' and uid <= 'D3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'D1' and uid <= 'D3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'D1' and uid <= 'D3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'D1' and uid <= 'D3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'D3' and uid <= 'D5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'D3' and uid <= 'D5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'D3' and uid <= 'D5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'D3' and uid <= 'D5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'D5' and uid <= 'D7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'D5' and uid <= 'D7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'D5' and uid <= 'D7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'D5' and uid <= 'D7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'D7' and uid <= 'D9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'D7' and uid <= 'D9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'D7' and uid <= 'D9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'D7' and uid <= 'D9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'D9' and uid <= 'DB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'D9' and uid <= 'DB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'D9' and uid <= 'DB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'D9' and uid <= 'DB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'DB' and uid <= 'DD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'DB' and uid <= 'DD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'DB' and uid <= 'DD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'DB' and uid <= 'DD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'DD' and uid <= 'DF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'DD' and uid <= 'DF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'DD' and uid <= 'DF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'DD' and uid <= 'DF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'DF' and uid <= 'E1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'DF' and uid <= 'E1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'DF' and uid <= 'E1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'DF' and uid <= 'E1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'E1' and uid <= 'E3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'E1' and uid <= 'E3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'E1' and uid <= 'E3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'E1' and uid <= 'E3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'E3' and uid <= 'E5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'E3' and uid <= 'E5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'E3' and uid <= 'E5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'E3' and uid <= 'E5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'E5' and uid <= 'E7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'E5' and uid <= 'E7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'E5' and uid <= 'E7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'E5' and uid <= 'E7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'E7' and uid <= 'E9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'E7' and uid <= 'E9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'E7' and uid <= 'E9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'E7' and uid <= 'E9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'E9' and uid <= 'EB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'E9' and uid <= 'EB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'E9' and uid <= 'EB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'E9' and uid <= 'EB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'EB' and uid <= 'ED'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'EB' and uid <= 'ED'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'EB' and uid <= 'ED'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'EB' and uid <= 'ED'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'ED' and uid <= 'EF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'ED' and uid <= 'EF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'ED' and uid <= 'EF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'ED' and uid <= 'EF'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'EF' and uid <= 'F1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'EF' and uid <= 'F1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'EF' and uid <= 'F1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'EF' and uid <= 'F1'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'F1' and uid <= 'F3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'F1' and uid <= 'F3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'F1' and uid <= 'F3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'F1' and uid <= 'F3'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'F3' and uid <= 'F5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'F3' and uid <= 'F5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'F3' and uid <= 'F5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'F3' and uid <= 'F5'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'F5' and uid <= 'F7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'F5' and uid <= 'F7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'F5' and uid <= 'F7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'F5' and uid <= 'F7'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'F7' and uid <= 'F9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'F7' and uid <= 'F9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'F7' and uid <= 'F9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'F7' and uid <= 'F9'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'F9' and uid <= 'FB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'F9' and uid <= 'FB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'F9' and uid <= 'FB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'F9' and uid <= 'FB'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'FB' and uid <= 'FD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'FB' and uid <= 'FD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'FB' and uid <= 'FD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'FB' and uid <= 'FD'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    INSERT INTO kosm.id_up_20160817 SELECT 
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+).*') AND uid > 'FD' and uid <= 'G'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/.*', '\\1') ;

    INSERT INTO kosm.id_up_20160817 SELECT
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+).*')  AND uid > 'FD' and uid <= 'G'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+).*', '\\1[0]\\2') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'FD' and uid <= 'G'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[1]\\3') ;

    INSERT INTO kosm.id_up_20160817 SELECT distinct
        ymd,
        uid,
        replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4')  AS up,
        toUInt32(count()) as cnt,
        toUInt32(max(ts) - min(ts)) as duration
    FROM rlog_20160817
    WHERE match(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*') AND uid > 'FD' and uid <= 'G'
    GROUP BY ymd, uid, replaceRegexpOne(url, '^([^/?#]+)/([^/?#]+)/([^/?#]+)/([^/?#]+).*', '\\1[2]\\4') ;

    DROP TABLE IF EXISTS kosm.id_posit_20160817;
    
    CREATE TABLE kosm.id_posit_20160817 ENGINE =  TinyLog as
    SELECT
       uid
    FROM
       rlog_20160817
    WHERE
       url like '%raiffeisen.ru/retail/cards/credit%'
    ;
    
    DROP TABLE IF EXISTS kosm.up_20160817;
    CREATE TABLE kosm.up_20160817 
       (ymd Date, up String, total UInt32, positive UInt16, score Int32)
    ENGINE = MergeTree(ymd, (up, ymd), 8192);
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 0
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 1
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 2
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 3
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 4
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 5
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 6
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 7
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 8
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 9
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 10
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 11
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 12
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 13
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 14
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 15
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 16
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 17
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 18
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 19
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 20
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 21
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 22
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 23
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 24
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 25
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 26
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 27
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 28
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 29
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 30
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    
    INSERT INTO kosm.up_20160817
    SELECT
        ymd,
        up,
        toUInt32(total) as total,
        toUInt16(positive) as positive,
        toInt32(100000 * log((positive + 0.1)/(total - positive + 0.1))) as score
    FROM
       (SELECT 
           ymd,
           up, 
           count() as total,
           sum(if(uid in (select uid from kosm.id_posit_20160817), 1, 0)) as positive
       FROM
          kosm.id_up_20160817
       WHERE 
          NOT up like '%raiffeisen.ru%'
          AND cityHash64(up) % 32 = 31
       GROUP BY 
          ymd, up
       )
    WHERE
       total > 50
       OR positive > 2
    ;
    